<div class="container m-auto">
  <!-- User details -->
  <div class="mb-5 d-flex flex-column align-items-center text-center">
    <h1>Hello, I'm <%= @user.username %>!</h1>
    <% if current_user.photo.attachment.nil? %>
      <%= image_tag "avatar.png", alt: "Profile Picture", class: "avatar avatar--large mb-4" %>
        <% else %>
      <%= cl_image_tag current_user.photo.key %>
    <% end %>
    <% unless @user.description.nil? %>
      <p><strong>About me:</strong></p>
      <p><%= @user.description %></p>
    <% end %>
    <!-- Edit profile -->
    <button type="button" class="btn btn-primary" data-toggle="modal" data-target="#userProfileModal">Edit Profile</button>
  </div>

  <!-- Listings -->
  <h3>My Listings:</h3>
  <% if @user.surfboards.count.zero? %>
    <div class="alert alert-warning position-static" role="alert">
      No current listings
      <button type="button" class="close" data-dismiss="alert" aria-label="Close">
        <span aria-hidden="true">&times;</span>
      </button>
    </div>
  <% else %>
    <div class="row">
      <% @user.surfboards.each do |surfboard| %>
        <div class="card card__index col-12 col-sm-6 col-md-4 col-lg-3">
          <%= link_to surfboard_path(surfboard) do %>
            <%= cl_image_tag surfboard.photo.key, class: "card__image" %>
            <h5><%= surfboard.name %></h5>
            <%= link_to "View listing", surfboard_path(surfboard), class: "link pb-3" %>
          <% end %>
        </div>
      <% end %>
    </div>
  <% end %>

  <% if @user.bookings.count.zero? %>
    <h3>Bookings:</h3>
    <div class="alert alert-warning position-static" role="alert">
      No current bookings
      <button type="button" class="close" data-dismiss="alert" aria-label="Close">
        <span aria-hidden="true">&times;</span>
      </button>
    </div>
  <% else %>
  <!-- I've rented out these boards -->
    <h3>You've booked:</h3>
    <div class="row">
      <% @user.bookings.each do |booking| %>
        <div class="card card__index col-12 col-sm-6 col-md-4 col-lg-3">
          <%= link_to booking_path(booking) do %>
            <%= cl_image_tag booking.surfboard.photo.key, class: "card__image" %>
            <h5><%= booking.surfboard.name %></h5>
            <p>Renting from: <%= "#{booking.surfboard.user.username}" %></p>
            <p>From: <%= "#{booking.start_date.to_formatted_s(:short)}" %> | To: <%= "#{booking.end_date.to_formatted_s(:short)}" %></p>
            <p><strong>Total price: <%= number_to_currency(booking.total_price, precision: 0) %></strong></p>
            <%= link_to "View booking", booking_path(booking), class: "link pb-3" %>
          <% end %>
        </div>
      <% end %>
    </div>
  <!-- Other's have rented out my board -->
    <h3>Other's have booked your board:</h3>
    <div class="row">
      <% @user.surfboards.each do |surfboard| %>
      <% surfboard.bookings.each do |booking| %>
        <div class="card card__index col-12 col-sm-6 col-md-4 col-lg-3">
          <%= link_to booking_path(booking) do %>
            <%= cl_image_tag booking.surfboard.photo.key, class: "card__image" %>
            <h5><%= booking.surfboard.name %></h5>
            <p>Rented by: <%= "#{booking.user.username}" %></p>
            <p>From: <%= "#{booking.start_date.to_formatted_s(:short)} | #{booking.end_date.to_formatted_s(:short)}" %></p>
            <p><strong>Total price: <%= number_to_currency(booking.total_price, precision: 0) %></strong></p>
            <%= link_to "View booking", booking_path(booking), class: "link pb-3" %>
          <% end %>
        </div>
      <% end %>
    <% end %>
    </div>
  <% end %>
</div>

<!-- Modal edit form -->
<%= render "edit" %>
